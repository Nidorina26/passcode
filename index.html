<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Keypad Unlock Demo</title>
  <style>
    :root{--bg:#d0d0d0;--card:#f5f5f5;--btn:#e0e0e0;--accent:#444}
    html,body{height:100%;margin:0;font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial}
    .screen{
      background:var(--bg);
      height:100%;display:flex;align-items:center;justify-content:center;flex-direction:column;
    }
    .panel{width:360px;max-width:90%;background:transparent;display:flex;flex-direction:column;gap:18px;align-items:center}
    .display{width:100%;height:56px;border-radius:10px;background:rgba(255,255,255,0.1);display:flex;align-items:center;justify-content:center;font-size:22px;color:var(--accent);letter-spacing:6px}
    .keypad{width:100%;display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
    .key{height:64px;border-radius:10px;background:var(--card);display:flex;align-items:center;justify-content:center;font-size:20px;cursor:pointer;box-shadow:0 2px 0 rgba(0,0,0,0.06)}
    .key:active{transform:translateY(1px)}
    .row{display:flex;gap:12px;width:100%}
    .wide{grid-column:span 3;display:flex;gap:12px}
    .option-panel{display:flex;flex-direction:column;gap:12px;width:100%}
    .option{padding:14px;border-radius:10px;background:var(--btn);text-align:center;cursor:pointer}
    .hidden{display:none}
    .center-text{color:var(--accent);font-size:18px}
    .countdown{font-size:14px;color:#666}
    .reveal{font-family:monospace;background:rgba(255,255,255,0.08);padding:18px;border-radius:8px;white-space:pre-wrap;word-wrap:break-word}
    @media (max-width:420px){.display{font-size:18px;height:48px}}
  </style>
</head>
<body>
  <div class="screen">
    <div class="panel" id="panel">
      <div class="display" id="display">----</div>

      <div class="keypad" id="keypad">
        <!-- keys 1-9 -->
        <div class="key">1</div>
        <div class="key">2</div>
        <div class="key">3</div>
        <div class="key">4</div>
        <div class="key">5</div>
        <div class="key">6</div>
        <div class="key">7</div>
        <div class="key">8</div>
        <div class="key">9</div>
        <!-- special row -->
        <div class="key" id="del">⌫</div>
        <div class="key">0</div>
        <div class="key" id="enter">⏎</div>
      </div>

      <div class="option-panel hidden" id="options">
        <div class="center-text">Access granted — choose duration</div>
        <div class="option" data-ms="900000">Open for 15 minutes</div>
        <div class="option" data-ms="3600000">Open for 1 hour</div>
        <div class="option" data-ms="86400000">Open for the day</div>
      </div>

      <div class="center-text hidden" id="status">Status: idle</div>

      <div class="hidden" id="revealArea">
        <div class="countdown" id="countdown">Revealing in 60s</div>
        <div class="reveal" id="revealText"></div>
      </div>
    </div>
  </div>

  <script>
    // Minimal, single-file keypad unlock demo.
    (function(){
      const display = document.getElementById('display');
      const keypad = document.getElementById('keypad');
      const del = document.getElementById('del');
      const enter = document.getElementById('enter');
      const options = document.getElementById('options');
      const status = document.getElementById('status');
      const revealArea = document.getElementById('revealArea');
      const revealText = document.getElementById('revealText');
      const countdownEl = document.getElementById('countdown');

      let code = '';
      const MAX = 4;

      function renderDisplay(){
        if(code.length === 0) display.textContent = '----';
        else display.textContent = code.padEnd(4,'•');
      }

      // handle digit clicks
      keypad.addEventListener('click', e => {
        const key = e.target.closest('.key');
        if(!key) return;
        if(key.id === 'del') return handleDelete();
        if(key.id === 'enter') return handleEnter();
        const val = key.textContent.trim();
        if(!/^[0-9]$/.test(val)) return;
        if(code.length < MAX){ code += val; renderDisplay(); }
      });

      function handleDelete(){
        code = code.slice(0,-1);
        renderDisplay();
      }

      function handleEnter(){
        if(code.length !== MAX){
          // short, crisp feedback
          status.textContent = 'Enter 4 digits';
          status.classList.remove('hidden');
          setTimeout(()=>status.classList.add('hidden'),900);
          return;
        }
        // show options
        options.classList.remove('hidden');
        keypad.classList.add('hidden');
        status.classList.add('hidden');
      }

      // options click
      options.addEventListener('click', e => {
        const opt = e.target.closest('.option');
        if(!opt) return;
        const ms = Number(opt.dataset.ms) || 0;
        // user flow: show gray screen only, then after 60s reveal the code
        options.classList.add('hidden');
        // keep panel minimal: show countdown and revealed code after 60s
        revealArea.classList.remove('hidden');
        // hide keypad & display visually (we keep the gray background intact)
        document.getElementById('keypad').classList.add('hidden');
        // show just the simple status text for UX
        status.textContent = 'Locked — screen will reveal the code in 60 seconds.';
        status.classList.remove('hidden');

        // Start 60s reveal for demo (per request)
        let remaining = 60;
        countdownEl.textContent = 'Revealing in ' + remaining + 's';
        const tick = setInterval(()=>{
          remaining -= 1;
          countdownEl.textContent = 'Revealing in ' + remaining + 's';
          if(remaining <= 0){ clearInterval(tick); performReveal(); }
        },1000);

        // NOTE: the "ms" (selected duration) can be used to actually unlock for that period
        // For this demo, we don't implement full-time unlocking logic — this is the decision path.
      });

      function performReveal(){
        // show the actual digits (not masked)
        revealText.textContent = 'Entered 4-digit code: ' + code;
        countdownEl.textContent = '';
        status.textContent = 'Code revealed.';
      }

      // keyboard support
      window.addEventListener('keydown', e => {
        if(e.key === 'Backspace') return handleDelete();
        if(e.key === 'Enter') return handleEnter();
        if(/^[0-9]$/.test(e.key)){
          if(code.length < MAX){ code += e.key; renderDisplay(); }
        }
      });

      // initial render
      renderDisplay();
    })();
  </script>
</body>
</html>
